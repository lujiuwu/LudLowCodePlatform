(function(){"use strict";var e={2642:function(e,t,o){var n=o(6763),l=(o(9398),o(2606));const a={id:"app"};function r(e,t,o,n,r,u){const s=(0,l.g2)("PageEditor");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.bF)(s,{modelValue:n.state,"onUpdate:modelValue":t[0]||(t[0]=e=>n.state=e),formData:n.formData},null,8,["modelValue","formData"])])}var u=o(4982),s=o(1558),i=(0,l.pM)({props:{block:{type:Object},component:{type:Object}},setup(e,t){const o=(0,l.EW)({get(){return e.block},set(e){t.emit("update:block",e)}});let n={};function a(e){let{clientX:t,clientY:l}=e;const{startX:a,startY:r,startWidth:u,startHeight:s,direction:i,startTop:c,startLeft:p}=n;"center"===i.horizontal&&(t=a),"center"===i.vertical&&(l=r);let d=t-a,b=l-r;"start"===i.vertical&&(b=-b,o.value.top=c-b),"start"===i.horizontal&&(d=-d,o.value.left=p-d);const f=u+d,m=s+b;o.value.width=f,o.value.height=m,o.value.hasResize=!0}function r(){document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",r)}function u(t,o){t.stopPropagation(),n={startX:t.clientX,startY:t.clientY,startWidth:e.block.width,startHeight:e.block.height,startTop:e.block.top,startLeft:e.block.left,direction:o},document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",r)}const{width:s,height:i}=e.component.resize||{};return()=>(0,l.bF)(l.FK,null,[s&&(0,l.bF)(l.FK,null,[(0,l.bF)("div",{class:"block-resize block-resize-left",onMousedown:e=>u(e,{horizontal:"start",vertical:"center"})},null),(0,l.bF)("div",{class:"block-resize block-resize-right",onMousedown:e=>u(e,{horizontal:"end",vertical:"center"})},null)]),i&&(0,l.bF)(l.FK,null,[(0,l.bF)("div",{class:"block-resize block-resize-top",onMousedown:e=>u(e,{horizontal:"center",vertical:"start"})},null),(0,l.bF)("div",{class:"block-resize block-resize-bottom",onMousedown:e=>u(e,{horizontal:"center",vertical:"end"})},null)]),s&&i&&(0,l.bF)(l.FK,null,[(0,l.bF)("div",{class:"block-resize block-resize-top-left",onMousedown:e=>u(e,{horizontal:"start",vertical:"start"})},null),(0,l.bF)("div",{class:"block-resize block-resize-top-right",onMousedown:e=>u(e,{horizontal:"end",vertical:"start"})},null),(0,l.bF)("div",{class:"block-resize block-resize-bottom-left",onMousedown:e=>u(e,{horizontal:"start",vertical:"end"})},null),(0,l.bF)("div",{class:"block-resize block-resize-bottom-right",onMousedown:e=>u(e,{horizontal:"end",vertical:"end"})},null)])])}}),c=(o(3239),o(3325),o(5554)),p=o(2472),d=o(5857),b=(0,l.pM)({props:{btnInfo:{type:Object}},setup(e){return()=>(0,l.bF)(p.uD,{span:2,onClick:e.btnInfo.handler,class:"w-100% text-center cursor-pointer inner-content__header__menu__btn"},{default:()=>[(0,l.bF)(d.S2,{class:"w-100% font-size-16px",type:"primary"},{default:()=>["function"===typeof e.btnInfo.label?e.btnInfo.label():e.btnInfo.label]})]})}});function f(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,l.vv)(e)}var m=(0,l.pM)({props:{btnContent:{type:Array}},setup(e){return()=>{let t;return(0,l.bF)(c.S2,{class:"flex justify-center items-center gap-5px inner-content__header__menu"},f(t=e.btnContent.map(e=>(0,l.bF)(b,{btnInfo:e},null)))?t:{default:()=>[t]})}}}),v=o(1507),h=o(6223),g=o(1927);function y(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,l.vv)(e)}var k=(0,l.pM)({props:{currentTab:{type:String},isOpenAside:{type:Boolean}},setup(e,t){const o=(0,l.EW)({get(){return e.currentTab},set(e){t.emit("update:currentTab",e)}}),a=(0,l.EW)({get(){return e.isOpenAside},set(e){t.emit("update:isOpenAside",e)}}),r=[{label:"基础组件",name:"basicComponent",icon:()=>(0,l.bF)(v.vdG,null,null)},{label:"布局容器",name:"pageContainer",icon:()=>(0,l.bF)(v.W1t,null,null)},{label:"反馈组件",name:"feedBack",icon:()=>(0,l.bF)(v.MFV,null,null)}];function u(e){o.value=r[e].name}function s(){a.value=!a.value}return()=>{let e;return(0,l.bF)(l.FK,null,[(0,l.bF)("div",{class:"tabs-area"},[(0,l.bF)(h.q,{"tab-position":"left",onTabChange:u},y(e=r.map(e=>{let t;return(0,l.bF)(h.v$,{key:e.name,label:(0,l.bF)("div",{style:{display:"flex",alignItems:"center",gap:"4px",boxSizing:"border-box"}},[(0,l.bF)(g.tk,null,y(t=e.icon())?t:{default:()=>[t]}),(0,l.bF)("span",null,[e.label])])},null)}))?e:{default:()=>[e]})]),(0,l.bF)("div",{class:"icon-area"},[(0,l.bF)(g.tk,{onClick:s,size:"25"},{default:()=>[(0,l.bo)((0,l.bF)(v.avL,null,null),[[n.aG,a.value]]),(0,l.bo)((0,l.bF)(v.JaO,null,null),[[n.aG,!a.value]])]})])])}}}),F=o(9699),w=o(4060),x=o(706);const O=(0,l.pM)({name:"DialogComponent",props:{option:{type:Object}},setup(e,t){const o=(0,u.Kh)({option:{...e.option,content:e.option.content||""},isShow:!1});t.expose({showDialog(e){o.option={...e,content:e.content||""},o.isShow=!0}});const n={minRows:5,maxRows:10};function a(){o.option.onConfirm&&o.option.onConfirm(o.option.content),o.isShow=!1}function r(){o.isShow=!1}function s(){navigator.clipboard.writeText(o.option.content).then(()=>F.nk.success("已复制到剪贴板")).catch(e=>F.nk.error("复制失败: "+e.message))}return()=>(0,l.bF)(w.kZ,{modelValue:o.isShow,"onUpdate:modelValue":e=>o.isShow=e,title:o.option.title},{default:()=>(0,l.bF)(x.WK,{type:"textarea",modelValue:o.option.content,"onUpdate:modelValue":e=>o.option.content=e,placeholder:"请输入json内容",autosize:n},null),footer:()=>(0,l.bF)("div",{class:"dialog-footer"},[o.option.footer?(0,l.bF)(l.FK,null,[(0,l.bF)(d.S2,{type:"primary",onClick:a},{default:()=>[(0,l.eW)("确认")]}),(0,l.bF)(d.S2,{onClick:r},{default:()=>[(0,l.eW)("取消")]})]):(0,l.bF)(l.FK,null,[(0,l.bF)(d.S2,{type:"primary",onClick:s},{default:()=>[(0,l.eW)("复制")]}),(0,l.bF)(d.S2,{onClick:r},{default:()=>[(0,l.eW)("关闭")]})])])})}});let D;function C(e){if(!D){const t=document.createElement("div");D=(0,l.bF)(O,{option:e}),document.body.appendChild(((0,n.XX)(D,t),t))}const{showDialog:t}=D.component.exposed;t(e)}const S=(0,l.pM)({props:{label:String},setup(e){const t=(0,l.WQ)("hideDropdown");return()=>(0,l.bF)("div",{class:"dropdown-item",onClick:t},[(0,l.bF)("span",null,[e.label])])}}),E=(0,l.pM)({name:"DropDownComponent",props:{option:{type:Object}},setup(e,t){const o=(0,u.Kh)({option:e.option,isShow:!1,top:0,left:0});t.expose({showDropDown(e){o.option=e,o.isShow=!0;const{top:t,left:n,height:l}=e.el.getBoundingClientRect();o.top=t+l,o.left=n}}),(0,l.Gt)("hideDropdown",()=>{o.isShow=!1});const n=(0,l.EW)(()=>["dropdown",{"isShow-dropdown":o.isShow}]),a=(0,l.EW)(()=>({top:o.top+"px",left:o.left+"px"}));function r(e){s.value.contains(e.target)||(o.isShow=!1)}(0,l.sV)(()=>{document.body.addEventListener("mousedown",r,!0)}),(0,l.xo)(()=>{document.body.removeEventListener("mousedown",r)});const s=(0,u.KR)(null);return()=>(0,l.bF)("div",{class:n.value,style:a.value,ref:s},[o.option.content()])}});let _;function z(e){if(!_){const t=document.createElement("div");_=(0,l.bF)(E,{option:e}),document.body.appendChild(((0,n.XX)(_,t),t))}const{showDropDown:t}=_.component.exposed;t(e)}o(5786);var M=o(5179);const j=(0,l.pM)({name:"TableDialogComponent",props:{option:{type:Object}},setup(e,t){const o=(0,u.Kh)({option:e.option,isShow:!1,editData:[]});function n(){o.editData.push({})}function a(){o.option.confirm(o.editData),o.isShow=!1}function r(){o.isShow=!1}return t.expose({showTableDialog(e){o.option=e,o.isShow=!0,o.editData=JSON.parse(JSON.stringify(e.data))}}),()=>(0,l.bF)(w.kZ,{modelValue:o.isShow,"onUpdate:modelValue":e=>o.isShow=e,title:"添加下拉选项"},{default:()=>(0,l.bF)("div",null,[(0,l.bF)("div",{class:"button-area"},[(0,l.bF)(d.S2,{type:"primary",onClick:n},{default:()=>[(0,l.eW)("添加")]}),(0,l.bF)(d.S2,null,{default:()=>[(0,l.eW)("重置")]})]),(0,l.bF)(M.Up,{data:o.editData},{default:()=>[(0,l.bF)(M.o8,{type:"index"},null),o.option.config.table.options.map((e,t)=>(0,l.bF)(M.o8,{label:e.label},{default:({row:t})=>(0,l.bF)(x.WK,{modelValue:t[e.field],"onUpdate:modelValue":o=>t[e.field]=o},null)})),(0,l.bF)(M.o8,null,{default:()=>[(0,l.bF)(d.S2,{type:"danger"},{default:()=>[(0,l.eW)("删除")]})]})]})]),footer:()=>(0,l.bF)("div",null,[(0,l.bF)(d.S2,{type:"primary",onClick:a},{default:()=>[(0,l.eW)("确定")]}),(0,l.bF)(d.S2,{onClick:r},{default:()=>[(0,l.eW)("取消")]})])})}});let W,V;function L(e){W||(V=document.createElement("div"),W=(0,l.bF)(j,{option:e}),(0,n.XX)(W,V),document.body.appendChild(V));const{showTableDialog:t}=W.component.exposed;t(e)}var B=o(3321),K=(0,l.pM)({props:{propConfig:{type:Object},modelValue:{type:Array}},emits:["update:modelValue"],setup(e,t){const o=(0,l.EW)({get(){return e.modelValue||[]},set(e){t.emit("update:modelValue",JSON.parse(JSON.stringify(e)))}});function n(){L({config:e.propConfig,data:o.value,confirm(e){o.value=e}})}return()=>(0,l.bF)("div",null,[(!o.value||0===o.value.length)&&(0,l.bF)(d.S2,{onClick:n},{default:()=>[(0,l.eW)("添加")]}),(o.value||[]).map(t=>(0,l.bF)(B.u,null,{default:()=>[t[e.propConfig.table.key]]}))])}}),T=o(7957);function A(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,l.vv)(e)}var X=(0,l.pM)({setup(){function e(e){window.document.documentElement.setAttribute("data-skin",e)}const t=[{value:"default-theme",label:"默认主题"},{value:"dark-theme",label:"暗色主题"},{value:"candy-theme",label:"柔和主题"}],o=(0,u.KR)("default-theme");return()=>{let n;return(0,l.bF)(p.uD,{span:4,offset:20},{default:()=>[(0,l.bF)(T.AV,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,onChange:e},A(n=t.map((e,t)=>(0,l.bF)(T.P9,{key:t,value:e.value,label:e.label,disabled:e.value===o.value},null)))?n:{default:()=>[n]})]})}}}),I=(o(2917),(0,l.pM)({props:{block:{type:Object},formData:{type:Object}},setup(e,t){const o=(0,l.EW)({get:()=>e.block,set:e=>{t.emit("update:block",e)}}),n=(0,l.EW)({get:()=>e.formData,set:e=>{t.emit("update:formData",e)}}),a=(0,l.WQ)("config"),r=(0,l.EW)(()=>({top:o.value.top+"px",left:o.value.left+"px",zIndex:o.value.zIndex})),s=(0,u.KR)(null);return(0,l.sV)(()=>{const{offsetWidth:e,offsetHeight:t}=s.value;o.value.alignCenter&&(o.value.left=o.value.left-e/2,o.value.top=o.value.top-t/2,o.value.alignCenter=!1),o.value.width=e,o.value.height=t}),()=>{const t=a.componentMap.get(o.value.key);if(!t)return null;const u={size:e.block.hasResize?{width:e.block.width,height:e.block.height}:{},props:e.block.props,model:Object.keys(t.model||{}).reduce((e,t)=>{const l=o.value.model[t];return e[t]={modelValue:n.value[l],"onUpdate:modelValue":e=>{n.value[l]=e}},e},{})},c=t.render(u),{width:p,height:d}=t.resize||{};return(0,l.bF)("div",{draggable:!0,ref:s,style:r.value},[c,e.block.focus&&(p||d)&&(0,l.bF)(i,{class:"block-resize",block:e.block,component:t},null)])}}})),J=o(8572),P=o(2009),R=o(804);function U(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,l.vv)(e)}var N=(0,l.pM)({props:{block:{type:Object},data:{type:Object},updateContainer:{type:Function},updateBlock:{type:Function}},setup(e){const t=(0,l.WQ)("config"),o=(0,u.Kh)({editData:{}}),n=()=>{e.block?o.editData=JSON.parse(JSON.stringify(e.block)):o.editData=JSON.parse(JSON.stringify(e.data.container))};function a(){e.block?e.updateBlock(o.editData,e.block):e.updateContainer({...e.data,container:o.editData})}return(0,l.wB)(()=>e.block,n,{immediate:!0}),()=>{const r=[];if(e.block){const n=t.componentMap.get(e.block.key);n&&n.props&&r.push(Object.entries(n.props).map(([e,t])=>(0,l.bF)(J.xE,null,{default:()=>[(0,l.bF)("span",{class:"label"},[t.label]),{input:()=>(0,l.bF)(x.WK,{modelValue:o.editData.props[e],"onUpdate:modelValue":t=>o.editData.props[e]=t},null),color:()=>(0,l.bF)(R.rF,{modelValue:o.editData.props[e],"onUpdate:modelValue":t=>o.editData.props[e]=t},null),selector:()=>{let n;return(0,l.bF)(T.AV,{modelValue:o.editData.props[e],"onUpdate:modelValue":t=>o.editData.props[e]=t},U(n=t.options.map(e=>(0,l.bF)(T.P9,{label:e.label,value:e.value},null)))?n:{default:()=>[n]})},table:()=>(0,l.bF)(K,{propConfig:t,modelValue:o.editData.props[e],"onUpdate:modelValue":t=>o.editData.props[e]=t},{default:()=>[(0,l.eW)("s")]})}[t.type]()]}))),n&&n.model&&r.push(Object.entries(n.model).map(([e,t])=>(0,l.bF)(J.xE,{label:t},{default:()=>[(0,l.bF)(x.WK,{modelValue:o.editData.model[e],"onUpdate:modelValue":t=>o.editData.model[e]=t},null)]})))}else r.push((0,l.bF)(J.xE,null,{default:()=>[(0,l.bF)("span",{class:"label"},[(0,l.eW)("容器宽度")]),(0,l.bF)(P.lq,{modelValue:o.editData.width,"onUpdate:modelValue":e=>o.editData.width=e,step:5},null)]})),r.push((0,l.bF)(J.xE,null,{default:()=>[(0,l.bF)("span",{class:"label"},[(0,l.eW)("容器高度")]),(0,l.bF)(P.lq,{modelValue:o.editData.height,"onUpdate:modelValue":e=>o.editData.height=e,step:5},null)]}));return(0,l.bF)(J.US,{labelPosition:"top"},{default:()=>[r,(0,l.bF)(J.xE,null,{default:()=>[(0,l.bF)(d.S2,{type:"primary",onClick:()=>a()},{default:()=>[(0,l.eW)("应用")]}),(0,l.bF)(d.S2,{onClick:n},{default:()=>[(0,l.eW)("重置")]})]})]})}}}),Q=(0,l.pM)({props:{btnContent:{type:Array,required:!0}},setup(e){return()=>(0,l.bF)(s.bZ,{class:"w-100% flex flex-col inner-content__header",height:"9vh"},{default:()=>[(0,l.bF)(m,{class:"flex-1",btnContent:e.btnContent},null),(0,l.bF)(c.S2,{class:"flex-1 flex items-center"},{default:()=>[(0,l.bF)(X,null,null)]})]})}}),Y=(0,l.pM)({props:{modelValue:{type:Object},formData:{type:Object},isPreview:{type:Boolean},menuShow:{type:Boolean},onContextMenuBlock:{type:Function},containerRef:{type:Object},OuterMouseDown:{type:Function},BlockMouseDown:{type:Function},markLine:{type:Object}},setup(e,t){const o=(0,l.EW)({get(){return e.modelValue},set(e){t.emit("update:modelValue",e)}}),n=(0,l.EW)(()=>({width:o.value.container.width+"px",height:o.value.container.height+"px"}));return()=>(0,l.bF)(s.ZO,null,{default:()=>[(0,l.bF)("div",{class:["inner-content__main"],style:n.value,ref:e.containerRef,onMousedown:e.OuterMouseDown},[o.value.blocks.map((t,o)=>(0,l.bF)(I,{formData:e.formData,block:t,onMousedown:n=>e.BlockMouseDown(n,t,o),class:["inner-content__main__block",t.focus?"inner-content__main__item--focus":"inner-content__main__item"],onContextmenu:o=>e.onContextMenuBlock(o,t)},null)),null!==e.markLine.x&&(0,l.bF)("div",{class:"inner-content__main__line-X",style:{left:e.markLine.x+"px"}},null),null!==e.markLine.y&&(0,l.bF)("div",{class:"inner-content__main__line-Y",style:{top:e.markLine.y+"px"}},null)])]})}}),G=(0,l.pM)({props:{width:{type:String},isOpenAside:{type:Boolean},DragFunction:{type:Function},DragEndFunction:{type:Function},componentList:{type:Array}},setup(e){const t=(0,u.KR)("basicComponent");return()=>(0,l.bF)(s.Mb,{style:{transition:"width 0.3s ease"},class:"outer-content__component-aside aside-color",width:e.width},{default:()=>[(0,l.bF)("div",{class:"component-aside__row"},[(0,l.bF)("div",{class:"component-aside__row__tabs"},[(0,l.bF)(k,{currentTab:t,"onUpdate:currentTab":e=>t=e,isOpenAside:e.isOpenAside,"onUpdate:isOpenAside":t=>e.isOpenAside=t},null)]),(0,l.bF)(n.eB,{name:"slide"},{default:()=>[(0,l.bo)((0,l.bF)("div",{class:"component-aside__row__components"},[e.componentList.map(t=>(0,l.bF)("div",{class:"component-aside__row__components__item"},[(0,l.bF)("div",{class:"component-aside__row__components__item__component",draggable:!0,onDragstart:o=>e.DragFunction(o,t),onDragend:o=>e.DragEndFunction(o,t)},[t.preview()]),(0,l.bF)("div",{class:"component-aside__row__components__item__label"},[t.label])]))]),[[n.aG,e.isOpenAside]])]})])]})}}),q=(0,l.pM)({props:{data:{type:Object},updateContainer:{type:Function},updateBlock:{type:Function},LastSelectedBlock:{type:Object}},setup(e){return()=>(0,l.bF)(s.Mb,{width:"220px",class:"outer-content__operator-aside aside-color"},{default:()=>[(0,l.bF)(N,{class:"outer-content__operator-aside__form",block:e.LastSelectedBlock,data:e.data,"onUpdate:data":t=>e.data=t,updateContainer:e.updateContainer,updateBlock:e.updateBlock},null)]})}}),Z=o(4265);const H=(0,Z.A)();function $(e,t){let o=null;function l(e){e.dataTransfer.dropEffect="move"}function a(e){e.preventDefault()}function r(e){e.dataTransfer.dropEffect="none"}function u(e){t.value={...t.value,blocks:t.value.blocks.concat([{top:e.offsetY,left:e.offsetX,key:o.key,zIndex:1,alignCenter:!0,props:{},model:{}}])},o=null}function s(t,s){const i=s.preview(),c=document.createElement("div");c.style.position="absolute",c.style.top="-9999px",document.body.appendChild(c),(0,n.XX)(i,c);const p=c.firstElementChild;p&&(p.style.opacity="0.7",p.style.pointerEvents="none",t.dataTransfer.setDragImage(p,0,0)),t.dataTransfer.setData("component",JSON.stringify(s)),e.value?.addEventListener("dragenter",l),e.value?.addEventListener("dragover",a),e.value?.addEventListener("dragleave",r),e.value?.addEventListener("drop",u),o=s,H.emit("start");const d=()=>{(0,n.XX)(null,c),document.body.removeChild(c)};setTimeout(d,0)}function i(t,o){e.value.removeEventListener("dragenter",l),e.value.removeEventListener("dragover",a),e.value.removeEventListener("dragleave",r),e.value.removeEventListener("drop",u),H.emit("end")}return{DragFunction:s,DragEndFunction:i}}o(6332);function ee(e,t,o,n){const a=(0,u.KR)(-1),r=(0,l.EW)(()=>e.value.blocks[a.value]);function s(){e.value.blocks.forEach(e=>{e.focus=!1})}function i(e,o,l){t.value||(e.preventDefault(),e.stopPropagation(),e.shiftKey?c.value.focusBlocks.length<=1?o.focus=!0:o.focus=!o.focus:(s(),o.focus?o.focus=!1:o.focus=!0),a.value=l,n(e))}const c=(0,l.EW)(()=>{const t=[],o=[];return e.value.blocks.forEach(e=>{e.focus?t.push(e):o.push(e)}),{focusBlocks:t,unfocusBlocks:o}});function p(){o.value||(o.value=!0),t.value||(s(),a.value=-1)}return{BlockMouseDown:i,BlocksObj:c,OuterMouseDown:p,LastSelectedBlock:r,ClearBlockFocus:s}}function te(e,t,o){const n={startX:0,startY:0,dragging:!1},l=(0,u.Kh)({x:null,y:null});function a(t){let{clientX:o,clientY:a}=t;n.dragging||(n.dragging=!0,H.emit("start"));const r=o-n.startX+n.startLeft,u=a-n.startY+n.startTop;let s=u+t.target.offsetHeight/2,i=r+t.target.offsetWidth/2;for(let e=0;e<n.lines.y.length;e++){const{top:t,showTop:o}=n.lines.y[e];if(Math.abs(t-u)<5){s=o,a=n.startY-n.startTop+t;break}}for(let e=0;e<n.lines.x.length;e++){const{left:t,showLeft:l}=n.lines.x[e];if(Math.abs(t-r)<5){i=l,o=n.startX-n.startLeft+t;break}}l.x=i,l.y=s;const c=o-n.startX,p=a-n.startY;e.value.focusBlocks.forEach((e,t)=>{e.top=n.startPos[t].top+p,e.left=n.startPos[t].left+c})}function r(e){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r),n.dragging&&H.emit("end"),l.x=null,l.y=null}function s(l){const{width:u,height:s}=t.value;n.dragging=!1,n.startX=l.clientX,n.startY=l.clientY,n.startPos=e.value.focusBlocks.map(({top:e,left:t})=>({top:e,left:t})),n.startLeft=t.value.left,n.startTop=t.value.top,n.lines=(()=>{const{unfocusBlocks:t}=e.value,n={x:[],y:[]},l=[...t,{top:0,left:0,width:o.value.width,hight:o.value.height}];return l.forEach(e=>{const{top:t,left:o,width:l,height:a}=e;n.y.push({showTop:t,top:t}),n.y.push({showTop:t,top:t-s}),n.y.push({showTop:t+a/2,top:t+a/2-s/2}),n.y.push({showTop:t+a,top:t+a}),n.y.push({showTop:t+a,top:t+a-s}),n.x.push({showLeft:o,left:o}),n.x.push({showTop:o+l/2,top:o+l/2-u/2}),n.x.push({showLeft:o+l,left:o+l}),n.x.push({showLeft:o+l,left:o+l-u}),n.x.push({showLeft:o,left:o-u})}),n})(),document.addEventListener("mousemove",a),document.addEventListener("mouseup",r)}return{InnerMouseDown:s,markLine:l}}function oe(e){const t={current:-1,commandQueue:[],commandsMap:new Map,commandsArray:[],destroyList:[]},o=e=>{t.commandsArray.push(e),t.commandsMap.set(e.name,(...o)=>{const{redo:n,undo:l}=e.execute(...o);if(n(),!e.isPushQueue)return;let{commandQueue:a,current:r}=t;a.length>0&&(a=a.slice(0,r+1),t.commandQueue=a),a.push({redo:n,undo:l}),t.current=r+1})};function n(){const e={90:"z",89:"y"},o=o=>{const{ctrlKey:n,keyCode:l}=o;let a=[];n&&a.push("ctrl"),a.push(e[l]),a=a.join("+"),t.commandsArray.forEach(({keyboard:e,name:n})=>{e&&e===a&&(t.commandsMap.get(n)(),o.preventDefault())})},n=()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)});return n}return o({name:"撤销",keyboard:"ctrl+z",execute:()=>({redo(){if(-1===t.current)return;const e=t.commandQueue[t.current];e&&(e.undo&&e.undo(),t.current--)}})}),o({name:"重做",keyboard:"ctrl+y",execute:()=>({redo(){const e=t.commandQueue[t.current+1];e&&(e.redo&&e.redo(),t.current++)}})}),o({name:"updateContainer",isPushQueue:!0,execute(t){const o={before:e.value,after:t};return{redo:()=>{e.value=o.after},undo:()=>{e.value=o.before}}}}),o({name:"updateBlock",isPushQueue:!0,execute(t,o){const n={before:e.value.blocks,after:(()=>{const n=[...e.value.blocks],l=e.value.blocks.indexOf(o);return l>-1&&n.splice(l,1,t),n})()};return{redo:()=>{e.value={...e.value,blocks:n.after}},undo:()=>{e.value={...e.value,blocks:n.before}}}}}),o({name:"drag",isPushQueue:!0,init(){this.before=null;const o=()=>{this.before=JSON.parse(JSON.stringify(e.value.blocks))},n=()=>t.commandsMap.get("drag")();return H.on("start",o),H.on("end",n),()=>{H.off("start",o),H.off("end",n)}},execute(){const t=this.before,o=JSON.parse(JSON.stringify(e.value.blocks));return{redo(){e.value.blocks=o},undo(){e.value.blocks=t}}}}),o({name:"toTop",isPushQueue:!0,execute(e){const{focusBlocks:t,unfocusBlocks:o}=e.value,n=o.reduce((e,t)=>Math.max(e,t.zIndex),-1/0),l=t.map(e=>e.zIndex);return t.forEach(e=>{e.zIndex=n+1}),{redo:()=>{t.forEach(e=>{e.zIndex=n+1})},undo:()=>{t.forEach((e,t)=>{e.zIndex=l[t]})}}}}),o({name:"toBottom",isPushQueue:!0,execute(e){const{focusBlocks:t,unfocusBlocks:o}=e.value,n=o.reduce((e,t)=>Math.min(e,t.zIndex),1/0),l=t.map(e=>e.zIndex);return t.forEach(e=>{e.zIndex=n-1}),{redo:()=>{t.forEach(e=>{e.zIndex=n-1})},undo:()=>{t.forEach((e,t)=>{e.zIndex=l[t]})}}}}),o({name:"delete",isPushQueue:!0,execute(t){const{unfocusBlocks:o}=t.value,n={before:JSON.parse(JSON.stringify(e.value.blocks)),after:o};return{redo:()=>{e.value.blocks=n.after},undo:()=>{e.value.blocks=n.before}}}}),(()=>{t.destroyList.push(n()),t.commandsArray.forEach(e=>e.init&&t.destroyList.push(e.init()))})(),(0,l.hi)(()=>{t.destroyList.forEach(e=>e&&e())}),t}var ne=(0,l.pM)({props:{modelValue:{type:Object},formData:{type:Object}},setup(e,t){const o=(0,u.KR)(!1),a=(0,u.KR)(!0);function r(e,t){e.preventDefault(),z({el:e.target,content:()=>(0,l.bF)(l.FK,null,[(0,l.bF)(S,{label:"删除",onClick:()=>{c.get("delete")(v)}},null),(0,l.bF)(S,{label:"置顶",onClick:()=>{c.get("toTop")(v)}},null),(0,l.bF)(S,{label:"置底",onClick:()=>{c.get("toBottom")(v)}},null),(0,l.bF)(S,{label:"查看",onClick:()=>{C({title:"查看",content:JSON.stringify(t),footer:!1})}},null),(0,l.bF)(S,{label:"导入",onClick:()=>{C({title:"导入",content:JSON.stringify(t),footer:!0,onConfirm:e=>{c.get("updateBlock")(JSON.parse(e),t)}})}},null)])})}const i=(0,l.EW)({get(){return e.modelValue},set(e){t.emit("update:modelValue",e)}}),{commandsMap:c}=oe(i),p=[{label:"撤销",handler:()=>c.get("撤销")()},{label:"重做",handler:()=>c.get("重做")()},{label:"导入",handler:()=>{C({title:"导入json",content:"",footer:!0,onConfirm:e=>{const t=JSON.parse(e);c.get("updateContainer")(t)}})}},{label:"导出",handler:()=>{C({title:"导出json",content:JSON.stringify(i.value),footer:!1})}},{label:"置顶",handler:()=>c.get("toTop")(v)},{label:"置底",handler:()=>c.get("toBottom")(v)},{label:"删除",handler:()=>c.get("delete")(v)},{label:()=>o.value?"编辑":"预览",handler:()=>{o.value=!o.value,y()}},{label:()=>a.value?"关闭":"打开",handler:()=>{a.value=!a.value}}],d=(0,u.KR)(null),{DragFunction:b,DragEndFunction:f}=$(d,i),{BlockMouseDown:m,BlocksObj:v,OuterMouseDown:h,LastSelectedBlock:g,ClearBlockFocus:y}=ee(i,o,a,e=>{_(e)}),k=(0,u.KR)("basicComponent"),F=(0,l.EW)(()=>(0,l.WQ)("config").componentList[k.value]||[]),w=(0,u.KR)(!0),x=(0,u.KR)(null),O=(0,u.KR)("280px"),D=(0,l.EW)(()=>x.value?x.value.offsetWidth+"px":"60px"),E=()=>{O.value=w.value?"280px":D.value};(0,l.sV)(()=>{E()});const{InnerMouseDown:_,markLine:M}=te(v,g,d);return()=>(0,l.bF)("div",{id:"pageEditor"},[(0,l.bF)(s.lX,{class:"outer-content main-color"},{default:()=>[(0,l.bo)((0,l.bF)(G,{width:O.value,isOpenAside:w.value,componentList:F.value,DragFunction:b,DragEndFunction:f},null),[[n.aG,a.value]]),(0,l.bF)(s.lX,{class:"inner-content box-color flex flex-col"},{default:()=>[(0,l.bo)((0,l.bF)(Q,{btnContent:p},null),[[n.aG,a.value]]),(0,l.bF)(Y,{modelValue:i.value,formData:e.formData,isPreview:o.value,menuShow:a.value,onContextMenuBlock:r,containerRef:d,OuterMouseDown:h,BlockMouseDown:m,markLine:M},null)]}),(0,l.bo)((0,l.bF)(q,{LastSelectedBlock:g.value,data:i.value,"onUpdate:data":e=>i.value=e,updateContainer:c.get("updateContainer"),updateBlock:c.get("updateBlock")},null),[[n.aG,a.value]])]})])}}),le=JSON.parse('{"container":{"width":900,"height":600},"blocks":[]}'),ae=o(3157),re=o(6322);function ue(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,l.vv)(e)}function se(){const e={basicComponent:[],pageContainer:[],feedBack:[]},t=new Map;return{componentList:e,componentMap:t,register:o=>{"basic"===o.type?e.basicComponent.push(o):"page"===o.type?e.pageContainer.push(o):e.feedBack.push(o),t.set(o.key,o)}}}const ie=se(),ce=e=>({type:"input",label:e}),pe=e=>({type:"color",label:e}),de=(e,t)=>({type:"selector",label:e,options:t}),be=(e,t)=>({type:"table",label:e,table:t});ie.register({label:"文本",key:"text",type:"basic",preview:()=>(0,l.bF)("span",{class:"preview"},[(0,l.eW)("预览文本")]),render:e=>e&&0!==Object.keys(e.props).length?(0,l.bF)("span",{style:{color:e.props.color,fontSize:e.props.size+"px"}},[e.props.text]):(0,l.bF)("span",null,[(0,l.eW)("默认内容")]),props:{text:ce("文本内容"),color:pe("文本颜色"),size:de("字体大小",[{label:"14px",value:"14px"},{label:"20px",value:"20px"}])}}),ie.register({label:"按钮",text:"按钮",type:"basic",preview:()=>(0,l.bF)(d.S2,{class:"preview"},{default:()=>[(0,l.eW)("预览按钮")]}),render:e=>e&&0!==Object.keys(e.props).length?(0,l.bF)(d.S2,{style:0!==Object.keys(e.size).length?{height:e.size.height+"px",width:e.size.width+"px"}:{},type:e.props.type,size:e.props.size},{default:()=>[e.props.text]}):(0,l.bF)(d.S2,{style:0!==Object.keys(e.size).length?{height:e.size.height+"px",width:e.size.width+"px"}:{}},{default:()=>[(0,l.eW)("按钮大小")]}),key:"button",props:{text:ce("按钮内容"),buttonType:de("按钮类型",[{label:"默认",value:"default"},{label:"基础",value:"primary"},{label:"成功",value:"success"},{label:"信息",value:"info"},{label:"警告",value:"warning"},{label:"危险",value:"danger"}]),buttonSize:de("按钮大小",[{label:"默认",value:"default"},{label:"大",value:"large"},{label:"小",value:"small"}])},resize:{width:!0,height:!0}}),ie.register({label:"输入框",text:"输入框",type:"basic",preview:()=>(0,l.bF)(x.WK,{class:"preview",placeholder:"预览输入框"},null),render:e=>e?(0,l.bF)(x.WK,{placeholder:"默认内容",size:e.props?.size,modelValue:e.model?.default?.modelValue,"onUpdate:modelValue":e.model?.default?.["onUpdate:modelValue"]},null):(0,l.bF)(x.WK,{placeholder:"默认内容"},null),key:"input",model:{default:"绑定字段"},props:{size:de("输入框尺寸",[{label:"默认",value:"default"},{label:"大",value:"large"},{label:"小",value:"small"}])},resize:{width:!0}}),ie.register({label:"下拉框",text:"下拉框",type:"basic",preview:()=>(0,l.bF)(T.AV,{class:"preview",placeholder:"请选择",style:"width: 100%"},null),render:e=>{if(e&&0!==Object.keys(e.props).length&&0!==Object.keys(e.model).length){let t;return(0,l.bF)(T.AV,(0,l.v6)(e.model.default,{style:"width: 240px",placeholder:"请选择"}),ue(t=(e.props.options||[]).map((e,t)=>{const o=String(e.value);return(0,l.bF)(T.P9,{key:t,label:e.label,value:o},null)}))?t:{default:()=>[t]})}return(0,l.bF)(T.AV,{style:"width: 240px",placeholder:"请选择"},null)},key:"selector",props:{options:be("下拉选项",{options:[{label:"显示值",field:"label"},{label:"绑定值",field:"value"}],key:"label"}),size:de("下拉框尺寸",[{label:"默认",value:"default"},{label:"大",value:"large"},{label:"小",value:"small"}])},model:{default:"绑定数据"}}),ie.register({label:"开关",key:"switch",type:"basic",preview:()=>(0,l.bF)(ae.qi,{class:"preview"},null),render:()=>(0,l.bF)(ae.qi,null,null),props:{}}),ie.register({label:"评分",type:"basic",key:"rate",preview:()=>(0,l.bF)(re.og,{class:"preview"},null),render:()=>(0,l.bF)(re.og,null,null),props:{}}),ie.register({label:"头部",type:"page",preview:()=>(0,l.bF)(s.bZ,{style:{width:"100%",backgroundColor:"#ccd9e6"},height:"30px"},{default:()=>[(0,l.eW)("头部")]}),render:()=>(0,l.bF)(s.bZ,{style:{width:"900px",backgroundColor:"#ccd9e6"},height:"40px"},{default:()=>[(0,l.eW)("头部")]}),resize:{width:!0,height:!0}}),ie.register({label:"侧边栏",type:"page",preview:()=>(0,l.bF)(s.Mb,{style:{height:"100%",backgroundColor:"#ccd9e6"},width:"100px"},{default:()=>[(0,l.eW)("侧边栏")]}),render:()=>(0,l.bF)(s.Mb,{style:{height:"900px",backgroundColor:"#ccd9e6"},width:"100px"},{default:()=>[(0,l.eW)("侧边栏")]}),resize:{width:!0,height:!0}});var fe={components:{PageEditor:ne},setup(){const e=(0,u.KR)(le);(0,l.Gt)("config",ie);const t=(0,u.KR)({username:"lujiuwu",password:"111"});return(0,l.sV)(()=>{window.document.documentElement.setAttribute("data-skin","default-theme")}),{state:e,formData:t}}},me=o(2744);const ve=(0,me.A)(fe,[["render",r]]);var he=ve,ge=o(515);const ye=[],ke=(0,ge.aE)({history:(0,ge.Bt)(),routes:ye});var Fe=ke,we=o(3764),xe=(0,we.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,n.Ef)(he).use(xe).use(Fe).mount("#app")}},t={};function o(n){var l=t[n];if(void 0!==l)return l.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,l,a){if(!n){var r=1/0;for(c=0;c<e.length;c++){n=e[c][0],l=e[c][1],a=e[c][2];for(var u=!0,s=0;s<n.length;s++)(!1&a||r>=a)&&Object.keys(o.O).every(function(e){return o.O[e](n[s])})?n.splice(s--,1):(u=!1,a<r&&(r=a));if(u){e.splice(c--,1);var i=l();void 0!==i&&(t=i)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,l,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0,198:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,a,r=n[0],u=n[1],s=n[2],i=0;if(r.some(function(t){return 0!==e[t]})){for(l in u)o.o(u,l)&&(o.m[l]=u[l]);if(s)var c=s(o)}for(t&&t(n);i<r.length;i++)a=r[i],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self["webpackChunklud"]=self["webpackChunklud"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[432,255,721,814,599,164,198,793,624,982,946,920,696,513,213,566,869],function(){return o(2642)});n=o.O(n)})();
//# sourceMappingURL=app.f1c8794d.js.map